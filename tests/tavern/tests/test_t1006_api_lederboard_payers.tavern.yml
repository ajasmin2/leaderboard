test_name: Leaderboard Get Players

includes:
  - !include config.yml

strict:
  - headers:on
  - json:on

stages:
  - name: Get Players Ranking
    request:
      url: "{url.api:s}/leaderboards/{leaderboard.leaderboard_to_rank:s}/players"
      method: GET
      headers:
        $ext:
          function: testing_utils:authorization_password_user
        accept: application/json
    response:
      status_code: 200
      verify_response_with:
        function: tavern.helpers:validate_pykwalify
        extra_kwargs:
          schema:
            type: map
            mapping:
              leaderbord_name:
                type: str
                required: True
              leaderbord_id:
                type: int
                required: True
              total_players:
                type: int
                required: True
              leaderboard_ranks:
                type: seq
                sequence:
                  - type: map
                    mapping:
                      rank:
                        type: int
                        required: True
                      player_id:
                        type: str
                        required: True
                      score:
                        type: int
                        required: True


